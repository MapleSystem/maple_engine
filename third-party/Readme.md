## How we use Mozilla library for JS

The script maple_engine/maple_build/tools/build-maple-js.sh takes care of
downloading and building Mozilla Spider Monkey 31 used to compile 
JavaScript source code into JSOP byte codes.

### Fetching the source code

The script fetches the source from 
https://src.fedoraproject.org/repo/pkgs/mozjs31/mozjs-31.2.0.rc0.tar.bz2/d1ad39d0451b7231056a07bf1c57acee/mozjs-31.2.0.rc0.tar.bz2
The code is freely distributable subject to the terms of the Mozilla Public
License, v.2.0.

Plesae refer to the Mozilla Puiblic License version 2.0 LICENSE file for more detail. 
A copy of the Mozilla Public License version 2.0 is at mapleall/mozjs/mozjs-31.2.0/LICENSE.

### Building the library

The script downloads the Mozilla tar file from Fedora link above, configures and compiles
the source to build a static library named libjs_static.a which is linked into the
js2mpl binary.

### Interface to Mozilla

JS::Compile() is used to compile JavaScript source code into SpiderMonkey bytecode.
Other SpiderMonkey JS APIs are used to access the SpiderMonkey generated bytecode.


## How we use jscre library for JS RegExp

Overall, the script, maple_engine/maple_build/tools/build-maple-js.sh takes care
of the whole steps to use jscre library for JS RegExp.

### Fetching the source code

The script clones the source code from https://github.com/plenluno/jscre.git
to mapleall directory. jscre is freely distributable as long as the copyright notice
below is maintained:

Copyright (C) 2002, 2004, 2006, 2007 Apple Inc. All rights reserved.
Copyright (C) 2002, 2004, 2006, 2007, 2008 Apple Inc.  All rights reserved.
Copyright (C) 2007 Eric Seidel <eric@webkit.org>
Copyright (c) 1997-2005 University of Cambridge
Copyright (c) 1997-2005 University of Cambridge. All rights reserved.
Copyright (c) 1997-2006 University of Cambridge
Copyright (c) 2005, 2006, 2007 Apple Inc. All rights reserved.

Please refer to LICENSE file in jscre project for more detailed information.

### Building the library

The script copies the Cmake build script, maple_engine/third_party/CMakeLists.txt.jscre
to mapleall directory, compiles the source code, builds a static library named
libjscre.a under mapleall/jscre/build, and links it to libmplre-dyn.so.

### Interface to jscre

JS RegExp uses two main interfaces, dart::jscre::jsRegExpCompile() and
dart::jscre::jsRegExpExecute() to compile a given pattern, and execute pattern
matching for given pattern and subject.

In jscre, pattern and subject are represented as 16-bit strings (i.e., uint16_t
or UChar arrays). JS RegExp converts strings in 8-bit ASCII and 16-bit unicode
string format into 16-bit strings and feed them to jscre.

